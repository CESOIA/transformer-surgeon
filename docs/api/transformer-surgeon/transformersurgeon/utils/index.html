

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>transformer-surgeon.transformersurgeon.utils &mdash; transformer-surgeon 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />

  
    <link rel="canonical" href="https://CESOIA.github.io/transformer-surgeon/api/transformer-surgeon/transformersurgeon/utils/index.html" />
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            transformer-surgeon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">transformer-surgeon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">transformer-surgeon.transformersurgeon.utils</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/api/transformer-surgeon/transformersurgeon/utils/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-transformer-surgeon.transformersurgeon.utils">
<span id="transformer-surgeon-transformersurgeon-utils"></span><h1>transformer-surgeon.transformersurgeon.utils<a class="headerlink" href="#module-transformer-surgeon.transformersurgeon.utils" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="VCONBlock/index.html">transformer-surgeon.transformersurgeon.utils.VCONBlock</a></li>
<li class="toctree-l1"><a class="reference internal" href="checks/index.html">transformer-surgeon.transformersurgeon.utils.checks</a></li>
<li class="toctree-l1"><a class="reference internal" href="compression/index.html">transformer-surgeon.transformersurgeon.utils.compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration/index.html">transformer-surgeon.transformersurgeon.utils.configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="linearCompressed/index.html">transformer-surgeon.transformersurgeon.utils.linearCompressed</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager/index.html">transformer-surgeon.transformersurgeon.utils.manager</a></li>
</ul>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed" title="transformer-surgeon.transformersurgeon.utils.LinearCompressed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LinearCompressed</span></code></a></p></td>
<td><p>Linear layer with low-rank decomposition and optional structured pruning.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme" title="transformer-surgeon.transformersurgeon.utils.CompressionScheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompressionScheme</span></code></a></p></td>
<td><p>Represents a compression scheme for a transformer block.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager" title="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompressionSchemesManager</span></code></a></p></td>
<td><p>Manages multiple compression schemes for transformer models.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock" title="transformer-surgeon.transformersurgeon.utils.VCONBlock"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VCONBlock</span></code></a></p></td>
<td><p>Vanishing Contribution Block (VCONBlock).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#transformer-surgeon.transformersurgeon.utils.get_validated_value" title="transformer-surgeon.transformersurgeon.utils.get_validated_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_validated_value</span></code></a>(value, default[, min_value, max_value])</p></td>
<td><p>Returns <cite>value</cite> if it is not None and valid.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#transformer-surgeon.transformersurgeon.utils.get_validated_dict_value" title="transformer-surgeon.transformersurgeon.utils.get_validated_dict_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_validated_dict_value</span></code></a>(dictionary, key, index, default)</p></td>
<td><p>Returns the value for <cite>key</cite> in <cite>dictionary</cite> if present and valid.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transformer-surgeon.transformersurgeon.utils.</span></span><span class="sig-name descname"><span class="pre">LinearCompressed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrd_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code></p>
<p>Linear layer with low-rank decomposition and optional structured pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>int</em>) – Size of each input sample.</p></li>
<li><p><strong>out_features</strong> (<em>int</em>) – Size of each output sample.</p></li>
<li><p><strong>bias</strong> (<em>bool</em>) – If set to False, the layer will not learn an additive bias. Default: False.</p></li>
<li><p><strong>lrd_rank</strong> (<em>int</em><em> or </em><em>str</em>) – Rank for low-rank decomposition. Use a positive integer for the rank or “full” for no decomposition. Default: “full”.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Note: when low-rank decomposition is used, the weight matrix is split into two parts.</dt><dd><p>When using low-rank decomposition, concatenate the two decomposed matrices into a single weight tensor</p>
<blockquote>
<div><p>weight = torch.cat((weightA, weightB.T), dim=0)</p>
</div></blockquote>
<p>where weightA has shape (lrd_rank, in_features) and weightB has shape (out_features, lrd_rank).</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.prune_mask">
<span class="sig-name descname"><span class="pre">prune_mask</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.prune_mask" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.lrd_rank">
<span class="sig-name descname"><span class="pre">lrd_rank</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'full'</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.lrd_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.forward" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.set_lrd_rank">
<span class="sig-name descname"><span class="pre">set_lrd_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed.set_lrd_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.set_lrd_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.set_prune_mask">
<span class="sig-name descname"><span class="pre">set_prune_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed.set_prune_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.set_prune_mask" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.reset_prune_mask">
<span class="sig-name descname"><span class="pre">reset_prune_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed.reset_prune_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.reset_prune_mask" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed._check_rank">
<span class="sig-name descname"><span class="pre">_check_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed._check_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed._check_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.__repr__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.LinearCompressed.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/linearCompressed.html#LinearCompressed.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.LinearCompressed.__str__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.get_validated_value">
<span class="sig-prename descclassname"><span class="pre">transformer-surgeon.transformersurgeon.utils.</span></span><span class="sig-name descname"><span class="pre">get_validated_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/checks.html#get_validated_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.get_validated_value" title="Link to this definition"></a></dt>
<dd><p>Returns <cite>value</cite> if it is not None and valid.
If <cite>value</cite> is None, returns <cite>default</cite>.
If <cite>value</cite> is outside [min_value, max_value], raises ValueError.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – The value to validate.</p></li>
<li><p><strong>default</strong> – The default value to return if <cite>value</cite> is None.</p></li>
<li><p><strong>min_value</strong> – Minimum allowed value (inclusive).</p></li>
<li><p><strong>max_value</strong> – Maximum allowed value (inclusive).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The validated value or the default.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.get_validated_dict_value">
<span class="sig-prename descclassname"><span class="pre">transformer-surgeon.transformersurgeon.utils.</span></span><span class="sig-name descname"><span class="pre">get_validated_dict_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/checks.html#get_validated_dict_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.get_validated_dict_value" title="Link to this definition"></a></dt>
<dd><p>Returns the value for <cite>key</cite> in <cite>dictionary</cite> if present and valid.
If the key is missing or the value is None, returns <cite>default</cite>.
If the value is outside [min_value, max_value], raises ValueError.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> (<em>Dict</em>) – The dictionary to get the value from.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – The key to look for in the dictionary.</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index to use if the value is a list.</p></li>
<li><p><strong>default</strong> – The default value to return if the key is missing or value is None.</p></li>
<li><p><strong>min_value</strong> – Minimum allowed value (inclusive).</p></li>
<li><p><strong>max_value</strong> – Maximum allowed value (inclusive).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The validated value or the default.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transformer-surgeon.transformersurgeon.utils.</span></span><span class="sig-name descname"><span class="pre">CompressionScheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pruning_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrd_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_qkv_concatenated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme" title="Link to this definition"></a></dt>
<dd><p>Represents a compression scheme for a transformer block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the layer inside the block.</p></li>
<li><p><strong>block_id</strong> (<em>int</em>) – Block identifier.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to the block in the model.</p></li>
<li><p><strong>pruning_ratio</strong> (<em>float</em>) – Ratio for structured pruning.</p></li>
<li><p><strong>lrd_rank</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em>) – Rank for low-rank decomposition. Use “full” for no decomposition.</p></li>
<li><p><strong>is_qkv_concatenated</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether QKV layers are concatenated in the model definition.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em><em>, </em><em>optional</em>) – Reference to the model.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.get_module">
<span class="sig-name descname"><span class="pre">get_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.get_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.get_module" title="Link to this definition"></a></dt>
<dd><p>Returns the module at the specified path.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.set_module">
<span class="sig-name descname"><span class="pre">set_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.set_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.set_module" title="Link to this definition"></a></dt>
<dd><p>Sets a new module at the specified path.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme._is_to_compress">
<span class="sig-name descname"><span class="pre">_is_to_compress</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._is_to_compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme._is_to_compress" title="Link to this definition"></a></dt>
<dd><p>Checks if compression should be applied.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme._module_copy">
<span class="sig-name descname"><span class="pre">_module_copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._module_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme._module_copy" title="Link to this definition"></a></dt>
<dd><p>Returns a copy of the module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.init_vcon">
<span class="sig-name descname"><span class="pre">init_vcon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.init_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.init_vcon" title="Link to this definition"></a></dt>
<dd><p>Initializes VCON block.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.cancel_vcon">
<span class="sig-name descname"><span class="pre">cancel_vcon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.cancel_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.cancel_vcon" title="Link to this definition"></a></dt>
<dd><p>Cancels VCON block.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.set_vcon_beta">
<span class="sig-name descname"><span class="pre">set_vcon_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.set_vcon_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.set_vcon_beta" title="Link to this definition"></a></dt>
<dd><p>Sets beta for VCON block.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.freeze_uncompressed_vcon">
<span class="sig-name descname"><span class="pre">freeze_uncompressed_vcon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.freeze_uncompressed_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.freeze_uncompressed_vcon" title="Link to this definition"></a></dt>
<dd><p>Freezes uncompressed VCON block.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.apply" title="Link to this definition"></a></dt>
<dd><p>Applies compression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.restore" title="Link to this definition"></a></dt>
<dd><p>Restores original module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme._structured_pruning">
<span class="sig-name descname"><span class="pre">_structured_pruning</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._structured_pruning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme._structured_pruning" title="Link to this definition"></a></dt>
<dd><p>Performs structured pruning.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme._low_rank_decomposition">
<span class="sig-name descname"><span class="pre">_low_rank_decomposition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._low_rank_decomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme._low_rank_decomposition" title="Link to this definition"></a></dt>
<dd><p>Performs low-rank decomposition.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.block_id">
<span class="sig-name descname"><span class="pre">block_id</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.block_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.path">
<span class="sig-name descname"><span class="pre">path</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.path" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.pruning_ratio">
<span class="sig-name descname"><span class="pre">pruning_ratio</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.pruning_ratio" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.lrd_rank">
<span class="sig-name descname"><span class="pre">lrd_rank</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.lrd_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.is_qkv_concatenated">
<span class="sig-name descname"><span class="pre">is_qkv_concatenated</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.is_qkv_concatenated" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.hard_applied">
<span class="sig-name descname"><span class="pre">hard_applied</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.hard_applied" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.soft_applied">
<span class="sig-name descname"><span class="pre">soft_applied</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.soft_applied" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.vcon_initialized">
<span class="sig-name descname"><span class="pre">vcon_initialized</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.vcon_initialized" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">get_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.get_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Returns the module connected to the compression scheme.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">set_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.set_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Sets a new module at the position specified by the compression scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_module</strong> (<em>torch.nn.Module</em>) – The new module to set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">_is_to_compress</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._is_to_compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Checks if compression has been set for the module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if compression should be applied, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">_module_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._module_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Returns a hard copy of the module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>module</strong> (<em>torch.nn.Module</em>) – Module to copy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Copied module.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">init_vcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.init_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Initializes a VCONBlock for the current module by duplicating it.
This method checks if compression is required and has not yet been applied.
If so, it creates a copy of the current module and instantiates a VCONBlock
with the original and copied modules as its components. The module is then
replaced with the VCONBlock. If <cite>verbose</cite> is True, a message indicating
successful initialization is printed. The method sets the <cite>vcon_initialized</cite>
flag to True upon completion.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If compression has already been applied (either soft or hard).</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints a message upon successful initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">cancel_vcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_block_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.cancel_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Cancels and removes the VCONBlock from the module, retaining either <cite>block_a</cite> or <cite>block_b</cite>.
This method replaces the current module containing a VCONBlock with either its <cite>block_a</cite> or <cite>block_b</cite> submodule,
depending on the value of <cite>keep_block_b</cite>. It also updates the internal state to reflect that the VCONBlock
is no longer initialized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_block_b</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, retains <cite>block_b</cite> after cancellation; otherwise, retains <cite>block_a</cite>.
Defaults to True.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints a message indicating which block was kept and the path of the module.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the VCONBlock is not initialized and cancellation is attempted.</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><ul class="simple">
<li><p>Replaces the current module with the selected block.</p></li>
<li><p>Updates <cite>self.vcon_initialized</cite> to False.</p></li>
<li><p>Optionally prints a message if <cite>verbose</cite> is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">set_vcon_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.set_vcon_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Set the beta value for the VCONBlock module.
This method updates the beta parameter of the VCONBlock, which controls the contribution
of each block in the model. The VCONBlock must be initialized before calling this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>float</em>) – The new beta value to set for the VCONBlock.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints a message indicating the beta value has been set. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the VCONBlock is not initialized.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">set_vcon_beta</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Set VCONBlock beta to 0.5 at &lt;path&gt;.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">freeze_uncompressed_vcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.freeze_uncompressed_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Freezes the parameters of the <cite>block_a</cite> submodule within a VCONBlock to prevent them from being updated during training.
This method sets <cite>requires_grad</cite> to <cite>False</cite> for all parameters in <cite>block_a</cite>, effectively freezing them.
It is typically used when you want to exclude the uncompressed part of the VCONBlock from optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints a message indicating that the parameters have been frozen. Default is False.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the VCONBlock has not been initialized (<cite>self.vcon_initialized</cite> is False).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Applies magnitude-based structured pruning and Low Rank Decomposition (LRD) to the target module.</p>
<dl class="simple">
<dt>Pruning:</dt><dd><ul class="simple">
<li><p>If <cite>pruning_ratio</cite> &gt; 0, performs structured pruning on the module’s weights.</p></li>
<li><p>If <cite>hard</cite> is True, pruned rows are permanently removed from the module’s weights and biases.</p></li>
<li><p>If <cite>hard</cite> is False, a prune mask is set for soft pruning (reversible).</p></li>
<li><p>Pruning is only applied once unless <cite>hard</cite> is specified after a soft application.</p></li>
</ul>
</dd>
<dt>Low Rank Decomposition (LRD):</dt><dd><ul class="simple">
<li><p>If <cite>lrd_rank</cite> is set and not “full”, applies LRD to the module’s weights.</p></li>
<li><p>If <cite>hard</cite> is False, stores the original weight matrix for possible restoration.</p></li>
<li><p>If <cite>hard</cite> is True, removes the stored original weight matrix.</p></li>
<li><p>LRD is only applied once unless <cite>hard</cite> is specified after a soft application.</p></li>
</ul>
</dd>
<dt>VCONBlock Handling:</dt><dd><ul class="simple">
<li><p>If the module is wrapped in a VCONBlock, compression is applied only to the second block (<cite>block_b</cite>).</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hard</strong> (<em>bool</em>) – If True, applies irreversible (hard) changes to the module. If False, applies reversible (soft) changes.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints detailed information about the application process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Restores the original state of the module by removing pruning and Low-Rank Decomposition (LRD) modifications.
If the module is wrapped in a VCONBlock, restoration is applied only to the second block (<cite>block_b</cite>).
The function reverses any soft-applied changes, such as pruning masks and LRD, but raises an error if hard-applied (non-reversible) changes have been made.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints information about the restoration process. Defaults to False.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the module has been hard applied and cannot be restored.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionScheme.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionScheme.__repr__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">_structured_pruning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pruning_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._structured_pruning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd><p>Returns a mask for structured pruning based on the specified norm.
This function generates a binary mask that can be applied to the weight tensor
to zero out entire rows (structured pruning) based on their L2 norm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> (<em>torch.nn.Module</em>) – The module containing the weight tensor to be pruned.</p></li>
<li><p><strong>norm</strong> (<em>int</em>) – The norm to use for calculating the importance of rows. Default is 2 (L2 norm).</p></li>
<li><p><strong>pruning_ratio</strong> (<em>float</em>) – The ratio of rows to prune (between 0 and 1). Default is 0.0 (no pruning).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A binary mask vector with the same number of elements as the rows of the weight tensor.
kept (int): Number of rows kept after pruning.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">_low_rank_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/compression.html#CompressionScheme._low_rank_decomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd><p>Performs low-rank decomposition on the given weight matrix using SVD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight</strong> (<em>torch.Tensor</em>) – The weight matrix to be decomposed.</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – The target rank for the decomposition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The first matrix of the low-rank decomposition.
torch.Tensor: The second matrix of the low-rank decomposition.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transformer-surgeon.transformersurgeon.utils.</span></span><span class="sig-name descname"><span class="pre">CompressionSchemesManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indexing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager" title="Link to this definition"></a></dt>
<dd><p>Manages multiple compression schemes for transformer models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Configuration dictionary for compression. You can use model.config.to_dict() to get this.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to be compressed.</p></li>
<li><p><strong>indexing</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – List of block-specific configuration dictionaries.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.init_vcon">
<span class="sig-name descname"><span class="pre">init_vcon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.init_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.init_vcon" title="Link to this definition"></a></dt>
<dd><p>Initialize VCON blocks for selected modules.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.cancel_vcon">
<span class="sig-name descname"><span class="pre">cancel_vcon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.cancel_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.cancel_vcon" title="Link to this definition"></a></dt>
<dd><p>Remove VCON blocks and restore original modules.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.set_vcon_beta">
<span class="sig-name descname"><span class="pre">set_vcon_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.set_vcon_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.set_vcon_beta" title="Link to this definition"></a></dt>
<dd><p>Set the beta parameter for VCON blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.freeze_uncompressed_vcon">
<span class="sig-name descname"><span class="pre">freeze_uncompressed_vcon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.freeze_uncompressed_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.freeze_uncompressed_vcon" title="Link to this definition"></a></dt>
<dd><p>Freeze original blocks in VCON.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.apply" title="Link to this definition"></a></dt>
<dd><p>Apply compression schemes to the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.restore" title="Link to this definition"></a></dt>
<dd><p>Restore the model to its original state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.init_vcon_all">
<span class="sig-name descname"><span class="pre">init_vcon_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.init_vcon_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.init_vcon_all" title="Link to this definition"></a></dt>
<dd><p>Initialize VCON for all modules.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.cancel_vcon_all">
<span class="sig-name descname"><span class="pre">cancel_vcon_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.cancel_vcon_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.cancel_vcon_all" title="Link to this definition"></a></dt>
<dd><p>Cancel VCON for all modules.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.set_vcon_beta_all">
<span class="sig-name descname"><span class="pre">set_vcon_beta_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.set_vcon_beta_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.set_vcon_beta_all" title="Link to this definition"></a></dt>
<dd><p>Set beta for all VCON blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.freeze_uncompressed_vcon_all">
<span class="sig-name descname"><span class="pre">freeze_uncompressed_vcon_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.freeze_uncompressed_vcon_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.freeze_uncompressed_vcon_all" title="Link to this definition"></a></dt>
<dd><p>Freeze all uncompressed VCON blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.apply_all">
<span class="sig-name descname"><span class="pre">apply_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.apply_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.apply_all" title="Link to this definition"></a></dt>
<dd><p>Apply all compression schemes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.restore_all">
<span class="sig-name descname"><span class="pre">restore_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.restore_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.restore_all" title="Link to this definition"></a></dt>
<dd><p>Restore all modules.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.config" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.indexing">
<span class="sig-name descname"><span class="pre">indexing</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.indexing" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.schemes">
<span class="sig-name descname"><span class="pre">schemes</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.schemes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">init_vcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.init_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd><p>Initializes VCON blocks for filtered modules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> – List of criteria to filter modules (by name or block_id)</p></li>
<li><p><strong>verbose</strong> – If True, prints information about the initialization process</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">cancel_vcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_block_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.cancel_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd><p>Cancels VCON blocks for filtered modules, keeping either block_a or block_b</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> – List of criteria to filter modules (by name or block_id)</p></li>
<li><p><strong>keep_block_b</strong> – If True, keeps the compressed block (block_b); otherwise keeps the original block (block_a)</p></li>
<li><p><strong>verbose</strong> – If True, prints information about the cancellation process</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">set_vcon_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.set_vcon_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd><p>Sets the beta value for filtered VCON-initialized blocks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> – The beta value to set (0 &lt;= beta &lt;= 1)</p></li>
<li><p><strong>criteria</strong> – List of criteria to filter modules (by name or block_id)</p></li>
<li><p><strong>verbose</strong> – If True, prints information about the beta setting process</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">freeze_uncompressed_vcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.freeze_uncompressed_vcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Freezes uncompressed blocks in filtered VCON-initialized modules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> – List of criteria to filter modules (by name or block_id)</p></li>
<li><p><strong>verbose</strong> – If True, prints information about the freezing process</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Applies filtered compression schemes to their respective modules in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> – List of criteria to filter modules (by name or block_id)</p></li>
<li><p><strong>hard</strong> – If True, applies hard compression (non-reversible); if False, applies soft compression (reversible)</p></li>
<li><p><strong>verbose</strong> – If True, prints information about the application process</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Restores filtered modules to their original state by removing pruning and LRD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> – List of criteria to filter modules (by name or block_id)</p></li>
<li><p><strong>verbose</strong> – If True, prints information about the restoration process</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">init_vcon_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.init_vcon_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Alias for init_vcon with criteria set to “all”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">cancel_vcon_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_block_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.cancel_vcon_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd><p>Alias for cancel_vcon with criteria set to “all”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">set_vcon_beta_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.set_vcon_beta_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Alias for set_vcon_beta with criteria set to “all”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">freeze_uncompressed_vcon_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.freeze_uncompressed_vcon_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd><p>Alias for freeze_uncompressed_vcon with criteria set to “all”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">apply_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.apply_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd><p>Alias for apply with criteria set to “all”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">restore_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.restore_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Alias for restore with criteria set to “all”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager._generate_schemes">
<span class="sig-name descname"><span class="pre">_generate_schemes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager._generate_schemes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager._generate_schemes" title="Link to this definition"></a></dt>
<dd><p>Generate compression schemes based on model configuration and indexing.
:returns: Nested dictionary of compression schemes organized by block type and block index.
:rtype: Dict[str, List[Dict[str, CompressionScheme]]]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.iter_filtered">
<span class="sig-name descname"><span class="pre">iter_filtered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.iter_filtered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.iter_filtered" title="Link to this definition"></a></dt>
<dd><p>Yields CompressionScheme objects filtered by name and/or block_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>criteria</strong> (<em>list</em>) – List of criteria to filter schemes. If even one of the criteria is not met, the scheme is skipped. Can include:
- int: Block ID to match
- str: Substring to match in the scheme name or path
- “all”: Matches all schemes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.__iter__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.__iter__" title="Link to this definition"></a></dt>
<dd><p>Yields all CompressionScheme objects from the nested dictionaries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager.__repr__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager._set_model">
<span class="sig-name descname"><span class="pre">_set_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/manager.html#CompressionSchemesManager._set_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.CompressionSchemesManager._set_model" title="Link to this definition"></a></dt>
<dd><p>Sets the model for each CompressionScheme in the manager.
:param model: The model to set for each compression scheme.
:type model: torch.nn.Module</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transformer-surgeon.transformersurgeon.utils.</span></span><span class="sig-name descname"><span class="pre">VCONBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.Module</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/VCONBlock.html#VCONBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
<p>Vanishing Contribution Block (VCONBlock).</p>
<p>Combines the outputs of the original and compressed modules using an affine combination controlled by beta.
When beta=1, the output is from the original module (block_a); when beta=0, the output is from the compressed module (block_b).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_module</strong> (<em>nn.Module</em>) – The original (uncompressed) module.</p></li>
<li><p><strong>compressed_module</strong> (<em>nn.Module</em>) – The compressed module.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/VCONBlock.html#VCONBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Computes the affine combination of original and compressed outputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock.set_beta">
<span class="sig-name descname"><span class="pre">set_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/VCONBlock.html#VCONBlock.set_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock.set_beta" title="Link to this definition"></a></dt>
<dd><p>Sets the beta parameter.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock.block_a">
<span class="sig-name descname"><span class="pre">block_a</span></span><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock.block_a" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock.block_b">
<span class="sig-name descname"><span class="pre">block_b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock.block_b" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock.beta">
<span class="sig-name descname"><span class="pre">beta</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock.beta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/VCONBlock.html#VCONBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">set_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/VCONBlock.html#VCONBlock.set_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Sets the beta parameter for the VCON block.</dt><dd><dl class="simple">
<dt>Args:</dt><dd><p>beta (float): The beta value to set (0 &lt;= beta &lt;= 1).</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If beta is not in the range [0, 1].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/VCONBlock.html#VCONBlock.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock.__repr__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transformer-surgeon.transformersurgeon.utils.VCONBlock.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/transformer-surgeon/transformersurgeon/utils/VCONBlock.html#VCONBlock.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transformer-surgeon.transformersurgeon.utils.VCONBlock.__str__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, CESOIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>